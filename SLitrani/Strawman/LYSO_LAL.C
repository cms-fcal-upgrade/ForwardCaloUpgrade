TSplineFit* LYSO_LAL(Bool_t todraw = kFALSE,Bool_t infile = kFALSE,Bool_t firstinfile = kFALSE)
//
// Arguments:
//
//  todraw       : true if the fit is to be drawn
//  infile       : true if the fit is to be put in file SplineFitDB.rdb
//  firstinfile  : if true, [BE CAREFUL: RISK OF LOOSING FILE SplineFitDB.rdb ]
//                 delete all fits present in file SplineFitDB.rdb and place
//                 this fit as the first fit in a new file SplineFitDB.rdb
//                 default false !!!
// All defaults for arguments correspond to the case where one calls this CINT
//macro from within a Litrani CINT macro to define a needed fit, instead of trying
//to find it in the database file SplineFitDB.rdb using TSplineFit::FindFit()
//
//  Absorption length of LYSO
//
//  Source : Ren-Yuan Zhu (via ECAL-HCAL Upgrade Simulations for HL-LHC)
//
{
  Int_t k1;
  Int_t k2 = -100;
  k1 = TClassTable::GetID("TSplineFit");
  if (k1<0) k2 = gSystem.Load("libSplineFit");
  const Int_t M = 121;
  const Int_t m = 1;
  Int_t i;
  TSplineFit *LALLength;
  Double_t x[M]= { 360.0000,
		   362.0000,
		   364.0000,
		   366.0000,
		   368.0000,
		   370.0000,
		   372.0000,
		   374.0000,
		   376.0000,
		   378.0000,
		   380.0000,
		   382.0000,
		   384.0000,
		   386.0000,
		   388.0000,
		   390.0000,
		   392.0000,
		   394.0000,
		   396.0000,
		   398.0000,
		   400.0000,
		   402.0000,
		   404.0000,
		   406.0000,
		   408.0000,
		   410.0000,
		   412.0000,
		   414.0000,
		   416.0000,
		   418.0000,
		   420.0000,
		   422.0000,
		   424.0000,
		   426.0000,
		   428.0000,
		   430.0000,
		   432.0000,
		   434.0000,
		   436.0000,
		   438.0000,
		   440.0000,
		   442.0000,
		   444.0000,
		   446.0000,
		   448.0000,
		   450.0000,
		   452.0000,
		   454.0000,
		   456.0000,
		   458.0000,
		   460.0000,
		   462.0000,
		   464.0000,
		   466.0000,
		   468.0000,
		   470.0000,
		   472.0000,
		   474.0000,
		   476.0000,
		   478.0000,
		   480.0000,
		   482.0000,
		   484.0000,
		   486.0000,
		   488.0000,
		   490.0000,
		   492.0000,
		   494.0000,
		   496.0000,
		   498.0000,
		   500.0000,
		   502.0000,
		   504.0000,
		   506.0000,
		   508.0000,
		   510.0000,
		   512.0000,
		   514.0000,
		   516.0000,
		   518.0000,
		   520.0000,
		   522.0000,
		   524.0000,
		   526.0000,
		   528.0000,
		   530.0000,
		   532.0000,
		   534.0000,
		   536.0000,
		   538.0000,
		   540.0000,
		   542.0000,
		   544.0000,
		   546.0000,
		   548.0000,
		   550.0000,
		   552.0000,
		   554.0000,
		   556.0000,
		   558.0000,
		   560.0000,
		   562.0000,
		   564.0000,
		   566.0000,
		   568.0000,
		   570.0000,
		   572.0000,
		   574.0000,
		   576.0000,
		   578.0000,
		   580.0000,
		   582.0000,
		   584.0000,
		   586.0000,
		   588.0000,
		   590.0000,
		   592.0000,
		   594.0000,
		   596.0000,
		   598.0000,
		   600.0000 };
  Double_t y[M]= {     3.3552,
		       3.3972,
		       3.4404,
		       3.4848,
		       3.5307,
		       3.5784,
		       3.6283,
		       3.6809,
		       3.7371,
		       3.7980,
		       3.8653,
		       3.9420,
		       4.0327,
		       4.1457,
		       4.2965,
		       4.5171,
		       4.8763,
		       5.5219,
		       6.7126,
		       8.7706,
		       12.0734,
		       17.2247,
		       25.2532,
		       37.5572,
		       55.3387,
		       78.2720,
		       103.1648,
		       126.3543,
		       147.1509,
		       166.5405,
		       185.4035,
		       204.1777,
		       222.9311,
		       241.4268,
		       259.1680,
		       275.4958,
		       289.7940,
		       301.7282,
		       311.3414,
		       318.9457,
		       324.9444,
		       329.7115,
		       333.5479,
		       336.6808,
		       339.2771,
		       341.4592,
		       343.3170,
		       344.9175,
		       346.3112,
		       347.5365,
		       348.6234,
		       349.5951,
		       350.4701,
		       351.2632,
		       351.9866,
		       352.6499,
		       353.2614,
		       353.8276,
		       354.3544,
		       354.8463,
		       355.3075,
		       355.7414,
		       356.1509,
		       356.5387,
		       356.9069,
		       357.2574,
		       357.5920,
		       357.9122,
		       358.2192,
		       358.5142,
		       358.7982,
		       359.0721,
		       359.3369,
		       359.5931,
		       359.8416,
		       360.0827,
		       360.3172,
		       360.5455,
		       360.7680,
		       360.9851,
		       361.1972,
		       361.4047,
		       361.6078,
		       361.8068,
		       362.0020,
		       362.1935,
		       362.3818,
		       362.5668,
		       362.7489,
		       362.9281,
		       363.1047,
		       363.2788,
		       363.4506,
		       363.6201,
		       363.7874,
		       363.9528,
		       364.1163,
		       364.2779,
		       364.4378,
		       364.5962,
		       364.7529,
		       364.9082,
		       365.0620,
		       365.2145,
		       365.3658,
		       365.5158,
		       365.6646,
		       365.8123,
		       365.9590,
		       366.1047,
		       366.2493,
		       366.3931,
		       366.5359,
		       366.6779,
		       366.8190,
		       366.9594,
		       367.0990,
		       367.2379,
		       367.3760,
		       367.5135,
		       367.6504 };
  
  //LALLength = new TSplineFit("BCF91A_Abs","Absorption Length for BCF91A | Fibre with WLS",20, M, x, y, 300.0, 800.0);
  // The value of 5 below (3rd parameter) corresponds to Absorption Length Spect (NOT WLS ABS LENGTH SPECT, that's 20)
  LALLength = new TSplineFit("AbsorptionLength_LYSO","Absorption Length for LYSO | LYSO Tile",5, M, x, y, 300.0, 800.0);
  LALLength->SetSource("Ren-Yuan Zhu");
  LALLength->SetMacro("LYSO_LAL.C");
  LALLength->SetXLabel("Wavelength [nm]");
  LALLength->SetVLabel("Absorption length [cm]");
  if (todraw) {
    LALLength->SetDefaultLabels();
    LALLength->DrawFit();
    LALLength->Print();
  }
  if (infile) {
    if (firstinfile) LALLength->UpdateFile(kTRUE);
    else             LALLength->UpdateFile(kFALSE);
  }
  return LALLength;
}
